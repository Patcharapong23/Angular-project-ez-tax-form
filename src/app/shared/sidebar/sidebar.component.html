<aside
  class="sidebar"
  [class.collapsed]="isCollapsed"
  [class.hover-expand]="hoverExpand"
  [class.mobile-mode]="isMobileView"
  [class.mobile-open]="isMobileView && mobileSidebarOpen"
  (mouseenter)="onMouseEnter()"
  (mouseleave)="onMouseLeave()"
>
  <div class="sidebar-header">
    <button
      class="circle-toggle"
      [class.locked]="isLocked"
      (click)="toggleLock()"
      aria-label="Toggle sidebar lock"
    >
      <span class="dot"></span>
    </button>

    <img class="brand-logo" src="assets/logo-ez-tax.svg" alt="EZ Tax Form" />
  </div>

  <nav class="sidebar-nav">
    <ul>
      <ng-container *ngFor="let item of filteredMenu">
        <!-- Single menu item (no children) -->
        <li *ngIf="!item.children || item.children.length === 0">
          <a
            class="nav-item"
            [routerLink]="item.route"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{ exact: item.key === 'dashboard' }"
            (click)="setActive(item.key)"
            [class.selected]="currentMain === item.key"
          >
            <i class="ti {{ item.icon }} nav-icon"></i>
            <span class="nav-label">{{ item.label }}</span>
          </a>
        </li>

        <!-- Menu with children (dropdown) -->
        <li *ngIf="item.children && item.children.length > 0">
          <div
            class="nav-item"
            (click)="toggleSubMenu(item.key)"
            [class.opened]="openSubMenu === item.key"
            [class.selected]="currentMain === item.key"
          >
            <i class="ti {{ item.icon }} nav-icon"></i>
            <span class="nav-label">{{ item.label }}</span>
            <i
              class="ti ti-chevron-right sub-arrow"
              [class.rotate]="openSubMenu === item.key"
            ></i>
          </div>

          <ul class="sub-menu" [class.open]="openSubMenu === item.key">
            <li *ngFor="let child of item.children">
              <a
                [routerLink]="child.route"
                routerLinkActive="active-sub"
                (click)="selectSub(item.key, child.key)"
              >
                {{ child.label }}
              </a>
            </li>
          </ul>
        </li>
      </ng-container>
    </ul>
  </nav>

  <!-- <div class="sidebar-footer">
    <a class="nav-item" (click)="logout()">
      <i class="ti ti-logout nav-icon"></i>
      <span class="nav-label">ออกจากระบบ</span>
    </a>
  </div> -->
</aside>
