<div class="auth-shell">
  <div class="auth-card">
    <img class="brand" src="assets/logo-ez-tax.svg" alt="EZ Tax Form" />
    <h1 class="title">สมัครสมาชิก</h1>
    <p class="subtitle">กรุณากรอกข้อมูลเพื่อสร้างบัญชีใหม่</p>
    <form class="reg-form" [formGroup]="form" (ngSubmit)="onSubmit()">
      <!-- ชื่อ-นามสกุล -->
      <mat-form-field
        appearance="outline"
        class="full-width"
        floatLabel="auto"
        subscriptSizing="dynamic"
        [hideRequiredMarker]="true"
      >
        <mat-label>ชื่อ-นามสกุล</mat-label>
        <input
          matInput
          formControlName="fullName"
          autocomplete="name"
          spellcheck="false"
        />
        <mat-error *ngIf="fullName?.hasError('required') && fullName?.touched"
          >กรุณากรอกชื่อ-นามสกุล</mat-error
        >
        <mat-error *ngIf="fullName?.hasError('minlength') && fullName?.touched"
          >อย่างน้อย 2 ตัวอักษร</mat-error
        >
      </mat-form-field>

      <!-- อีเมล -->
      <mat-form-field
        appearance="outline"
        class="full-width"
        floatLabel="auto"
        subscriptSizing="dynamic"
        [hideRequiredMarker]="true"
      >
        <mat-label>อีเมล</mat-label>
        <input
          matInput
          type="email"
          formControlName="email"
          autocomplete="email"
          inputmode="email"
          spellcheck="false"
        />
        <mat-error *ngIf="email?.hasError('required') && email?.touched"
          >กรุณากรอกอีเมล</mat-error
        >
        <mat-error *ngIf="email?.hasError('email') && email?.touched"
          >รูปแบบอีเมลไม่ถูกต้อง</mat-error
        >
      </mat-form-field>

      <!-- กลุ่มรหัสผ่าน -->
      <div formGroupName="passwordGroup" class="pw-grid">
        <mat-form-field
          appearance="outline"
          class="full-width"
          floatLabel="auto"
          subscriptSizing="dynamic"
          [hideRequiredMarker]="true"
        >
          <mat-label>รหัสผ่าน</mat-label>
          <input
            matInput
            [type]="hidePass ? 'password' : 'text'"
            formControlName="password"
            autocomplete="new-password"
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="hidePass = !hidePass"
            aria-label="แสดง/ซ่อนรหัสผ่าน"
          >
            <mat-icon>{{
              hidePass ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>
          <mat-hint>อย่างน้อย 6 ตัวอักษร</mat-hint>
          <mat-error *ngIf="password?.hasError('required') && password?.touched"
            >กรุณากรอกรหัสผ่าน</mat-error
          >
          <mat-error
            *ngIf="password?.hasError('minlength') && password?.touched"
            >อย่างน้อย 6 ตัวอักษร</mat-error
          >
        </mat-form-field>
        <div class="pw-meter">
          <div class="bar" [style.width.%]="passwordScore * 100"></div>
        </div>

        <!-- เช็คลิสต์เงื่อนไข -->
        <ul class="pw-req">
          <li [class.ok]="rules.minLen">
            <mat-icon class="ic">{{
              rules.minLen ? "check_circle" : "radio_button_unchecked"
            }}</mat-icon>
            ตัวอักษรภาษาอังกฤษอย่างน้อย 14 ตัวอักษร
          </li>
          <li [class.ok]="rules.hasDigit">
            <mat-icon class="ic">{{
              rules.hasDigit ? "check_circle" : "radio_button_unchecked"
            }}</mat-icon>
            ตัวเลข อย่างน้อย 1 ตัวอักษร เช่น 0-9
          </li>
          <li [class.ok]="rules.hasSpecial">
            <mat-icon class="ic">{{
              rules.hasSpecial ? "check_circle" : "radio_button_unchecked"
            }}</mat-icon>
            อักขระพิเศษ อย่างน้อย 1 ตัวอักษร เช่น !@#$
          </li>
        </ul>

        <mat-form-field
          appearance="outline"
          class="full-width"
          floatLabel="auto"
          subscriptSizing="dynamic"
          [hideRequiredMarker]="true"
        >
          <mat-label>ยืนยันรหัสผ่าน</mat-label>
          <input
            matInput
            [type]="hideConfirm ? 'password' : 'text'"
            formControlName="confirmPassword"
            autocomplete="new-password"
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="hideConfirm = !hideConfirm"
            aria-label="แสดง/ซ่อนยืนยันรหัสผ่าน"
          >
            <mat-icon>{{
              hideConfirm ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>
          <mat-error
            *ngIf="
              confirmPassword?.hasError('required') && confirmPassword?.touched
            "
            >กรุณายืนยันรหัสผ่าน</mat-error
          >
          <mat-error
            *ngIf="
              passwordGroup?.hasError('passwordsNotMatch') &&
              (confirmPassword?.dirty || confirmPassword?.touched)
            "
          >
            รหัสผ่านไม่ตรงกัน
          </mat-error>
        </mat-form-field>
      </div>

      <button
        class="button"
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="form.invalid"
      >
        สมัครสมาชิก
      </button>
    </form>

    <p class="foot-note">
      มีบัญชีใช้งานแล้วหรือยัง?
      <a class="link" routerLink="/login">เข้าสู่ระบบ</a>
      <!-- แก้ข้อความให้ถูก -->
    </p>
  </div>
</div>
